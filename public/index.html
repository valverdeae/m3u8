<!DOCTYPE html>
<html>
<head>
    <title>M3U8 Stream Proxy</title>
    <meta charset="UTF-8">
    <style>
        body { font-family: sans-serif; padding: 20px; max-width: 800px; margin: auto; }
        .card { border: 1px solid #ddd; padding: 20px; margin: 20px 0; border-radius: 10px; }
        .url { background: #f5f5f5; padding: 10px; border-radius: 5px; font-family: monospace; word-break: break-all; }
        button { background: #0070f3; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; }
        button:hover { background: #0051cc; }
        .status { padding: 5px 10px; border-radius: 5px; display: inline-block; }
        .online { background: #10b981; color: white; }
        .updating { background: #f59e0b; color: white; }
    </style>
</head>
<body>
    <h1>ðŸ“º M3U8 Stream Proxy</h1>
    
    <div class="card">
        <h2>ðŸ”„ Auto-updating every 1 minute</h2>
        <p>Last checked: <span id="lastUpdate">Checking...</span></p>
        <p>Status: <span id="status" class="status updating">Updating</span></p>
    </div>
    
    <div class="card">
        <h2>ðŸ“„ Alternate.TXT Version</h2>
        <p>Use this URL for .txt format:</p>
        <div class="url" id="txtUrl">Loading...</div>
        <button onclick="copyText('txtUrl')">Copy TXT URL</button>
    </div>
    
    <div class="card">
        <h2>ðŸŽ¬ M3U8 Version</h2>
        <p>Use this URL for standard .m3u8 format:</p>
        <div class="url" id="m3u8Url">Loading...</div>
        <button onclick="copyText('m3u8Url')">Copy M3U8 URL</button>
    </div>
    
    <div class="card">
        <h2>ðŸ“‹ Test in VLC</h2>
        <p>Open VLC â†’ Media â†’ Open Network Stream â†’ Paste URL:</p>
        <code>vlc "YOUR_URL_HERE"</code>
    </div>

    <script>
        // Set URLs
        const baseUrl = window.location.origin;
        document.getElementById('txtUrl').textContent = `${baseUrl}/api/alternate`;
        document.getElementById('m3u8Url').textContent = `${baseUrl}/api/stream`;
        
        // Check status
        async function checkStatus() {
            try {
                const res = await fetch('/api/update');
                const data = await res.json();
                
                if (data.success) {
                    document.getElementById('lastUpdate').textContent = new Date(data.timestamp).toLocaleString();
                    document.getElementById('status').textContent = 'Online';
                    document.getElementById('status').className = 'status online';
                }
            } catch (e) {
                console.log('Status check failed');
            }
        }
        
        // Copy function
        function copyText(elementId) {
            const text = document.getElementById(elementId).textContent;
            navigator.clipboard.writeText(text).then(() => {
                alert('URL copied to clipboard!');
            });
        }
        
        // Initial check
        checkStatus();
        // Check every 30 seconds
        setInterval(checkStatus, 30000);
    </script>
</body>
</html>
